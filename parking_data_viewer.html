<!--WSAA-project: Web Services and Applications.
This is a CRUD application for Cork City car parking data.
This HTML file provides a user interface for creating, reading, updating, and deleting car park data.
Author: Laura Lyons -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parking Management</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <div class="container mt-4">
        <h1 class="text-center">Parking Management Interface</h1>

        <!-- Section: Fetch Parking Data -->
        <div class="mb-4">
            <button id="fetchData" class="btn btn-primary">Fetch Parking Data</button>
            <div id="fetchResult" class="mt-3"></div>
        </div>

        <!-- Section: CRUD Operations -->
        <div class="mb-4">
            <h3>CRUD Operations</h3>
            <!-- Create Parking -->
            <h5>Create Parking Record</h5>
            <form id="createForm">
                <div class="row mb-2">
                    <div class="col">
                        <input type="number" id="createIdd" class="form-control" placeholder="ID" required>
                    </div>
                    <div class="col">
                        <input type="text" id="createName" class="form-control" placeholder="Parking Name" required>
                    </div>
                    <div class="col">
                        <input type="number" id="createSpaces" class="form-control" placeholder="Spaces Available" required>
                    </div>
                    <div class="col">
                        <input type="number" id="createFreeSpaces" class="form-control" placeholder="Free Spaces" required>
                    </div>
                </div>
                <div class="row mb-2">
                    <div class="col">
                        <input type="text" id="createOpeningTimes" class="form-control" placeholder="Opening Times" required>
                    </div>
                    <div class="col">
                        <input type="text" id="createHeightRestriction" class="form-control" placeholder="Height Restriction">
                    </div>
                    <div class="col">
                        <input type="text" id="createPricesRates" class="form-control" placeholder="Prices Rates">
                    </div>
                </div>
                <div class="row mb-2">
                    <div class="col">
                        <input type="number" step="0.0001" id="createLatitude" class="form-control" placeholder="Latitude" required>
                    </div>
                    <div class="col">
                        <input type="number" step="0.0001" id="createLongitude" class="form-control" placeholder="Longitude" required>
                    </div>
                </div>
                <button type="submit" class="btn btn-success">Create Parking Record</button>
            </form>
            <div id="createResult" class="mt-3"></div>

            <!-- Get Parking by ID -->
            <h5>Retrieve Parking Record by ID</h5>
            <form id="getForm">
                <div class="row mb-2">
                    <div class="col">
                        <input type="number" id="getIdd" class="form-control" placeholder="ID" required>
                    </div>
                </div>
                <button type="submit" class="btn btn-info">Retrieve Parking Record</button>
            </form>
            <div id="getResult" class="mt-3"></div>

            <!-- Update Parking -->
            <h5>Update Parking Record</h5>
            <form id="updateForm">
                <div class="row mb-2">
                    <div class="col">
                        <input type="number" id="updateIdd" class="form-control" placeholder="ID" required>
                    </div>
                    <div class="col">
                        <input type="text" id="updateName" class="form-control" placeholder="Parking Name">
                    </div>
                    <div class="col">
                        <input type="number" id="updateSpaces" class="form-control" placeholder="Spaces Available">
                    </div>
                    <div class="col">
                        <input type="number" id="updateFreeSpaces" class="form-control" placeholder="Free Spaces">
                    </div>
                </div>
                <button type="submit" class="btn btn-warning">Update Parking Record</button>
            </form>
            <div id="updateResult" class="mt-3"></div>

            <!-- Delete Parking -->
            <h5>Delete Parking Record</h5>
            <form id="deleteForm">
                <div class="row mb-2">
                    <div class="col">
                        <input type="number" id="deleteIdd" class="form-control" placeholder="ID" required>
                    </div>
                </div>
                <button type="submit" class="btn btn-danger">Delete Parking Record</button>
            </form>
            <div id="deleteResult" class="mt-3"></div>
        </div>
    </div>

    <script>
        // Fetch parking data
        $("#fetchData").click(function() {
            $.get("/api/fetch", function(data) {
                $("#fetchResult").html("<pre>" + JSON.stringify(data, null, 2) + "</pre>");
            }).fail(function(error) {
                $("#fetchResult").html("<pre>Error: " + JSON.stringify(error.responseJSON, null, 2) + "</pre>");
            });
        });

        // Create parking record
        $("#createForm").submit(function(e) {
            e.preventDefault();
            const payload = {
                idd: $("#createIdd").val(),
                parking_name: $("#createName").val(),
                spaces_available: $("#createSpaces").val(),
                free_spaces: $("#createFreeSpaces").val(),
                opening_times: $("#createOpeningTimes").val(),
                height_restriction: $("#createHeightRestriction").val(),
                prices_rates: $("#createPricesRates").val(),
                latitude: $("#createLatitude").val(),
                longitude: $("#createLongitude").val(),
            };
            $.ajax({
                url: "/api/parking",
                method: "POST",
                contentType: "application/json",
                data: JSON.stringify(payload),
                success: function(data) {
                    $("#createResult").html("<pre>" + JSON.stringify(data, null, 2) + "</pre>");
                },
                error: function(error) {
                    $("#createResult").html("<pre>Error: " + JSON.stringify(error.responseJSON, null, 2) + "</pre>");
                }
            });
        });

        // Get parking record by ID
        $("#getForm").submit(function(e) {
            e.preventDefault();
            const id = $("#getIdd").val();
            $.get(`/api/parking/${id}`, function(data) {
                $("#getResult").html("<pre>" + JSON.stringify(data, null, 2) + "</pre>");
            }).fail(function(error) {
                $("#getResult").html("<pre>Error: " + JSON.stringify(error.responseJSON, null, 2) + "</pre>");
            });
        });

        // Update parking record
        $("#updateForm").submit(function(e) {
            e.preventDefault();
            const id = $("#updateIdd").val();
            const payload = {
                parking_name: $("#updateName").val(),
                spaces_available: $("#updateSpaces").val(),
                free_spaces: $("#updateFreeSpaces").val(),
            };
            $.ajax({
                url: `/api/parking/${id}`,
                method: "PUT",
                contentType: "application/json",
                data: JSON.stringify(payload),
                success: function(data) {
                    $("#updateResult").html("<pre>" + JSON.stringify(data, null, 2) + "</pre>");
                },
                error: function(error) {
                    $("#updateResult").html("<pre>Error: " + JSON.stringify(error.responseJSON, null, 2) + "</pre>");
                }
            });
        });

        // Delete parking record
        $("#deleteForm").submit(function(e) {
            e.preventDefault();
            const id = $("#deleteIdd").val();
            $.ajax({
                url: `/api/parking/${id}`,
                method: "DELETE",
                success: function(data) {
                    $("#deleteResult").html("<pre>" + JSON.stringify(data, null, 2) + "</pre>");
                },
                error: function(error) {
                    $("#deleteResult").html("<pre>Error: " + JSON.stringify(error.responseJSON, null, 2) + "</pre>");
                }
            });
        });
    </script>
</body>
</html>
